<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âõ¢ÈòüÂÜÖÈÉ®ÂØºËà™ | Dev Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Ëá™ÂÆö‰πâÁÆÄÂçïÁöÑ Toast ÊèêÁ§∫Âä®Áîª */
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
        .toast {
            animation: fadeInOut 2s ease-in-out forwards;
        }
        
        /* Èº†Ê†áÊÇ¨ÂÅúÊòæÁ§∫Â§çÂà∂ÊèêÁ§∫ */
        .copy-hover:hover {
            background-color: #f1f5f9; /* slate-100 */
            cursor: pointer;
            border-radius: 4px;
            position: relative;
        }
        .copy-hover:active {
            background-color: #e2e8f0; /* slate-200 */
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans antialiased selection:bg-blue-100">

    <header class="bg-white border-b border-slate-200 sticky top-0 z-10 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold">
                    D
                </div>
                <h1 class="text-xl font-bold text-slate-800 tracking-tight">Dev<span class="text-blue-600">Portal</span></h1>
                <span class="px-2 py-0.5 rounded-full bg-slate-100 text-slate-500 text-xs font-medium border border-slate-200">Internal</span>
            </div>
            
            <div class="flex items-center gap-4">
                <div id="admin-bar" class="hidden items-center gap-3 animate-fade-in">
                    <span class="text-xs text-green-600 font-medium bg-green-50 px-2 py-1 rounded border border-green-100">
                        <i class="fa-solid fa-user-check mr-1"></i> <span id="admin-id"></span>
                    </span>
                    <button onclick="saveConfig()" class="text-sm bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded shadow-sm transition">
                        ‰øùÂ≠òÈÖçÁΩÆ
                    </button>
                    <button onclick="exitEditMode()" class="text-sm text-slate-500 hover:text-slate-700 px-2">
                        ÈÄÄÂá∫
                    </button>
                </div>

                <button id="auth-btn" onclick="requestAuth()" class="text-slate-400 hover:text-blue-600 transition p-2" title="ÁÆ°ÁêÜÊ®°Âºè">
                    <i class="fa-solid fa-lock"></i>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-10" id="app">
        </main>

    <div id="toast-container" class="fixed bottom-5 right-5 z-50 flex flex-col gap-2"></div>

    <script>
        // ================= Êï∞ÊçÆÂÆö‰πâ =================
        // ÂÆûÈôÖÂú∫ÊôØ‰∏≠ÔºåËøô‰∫õÊï∞ÊçÆÂ∫îËØ•‰ªéÂêéÁ´Ø API Ëé∑Âèñ
        const mockData = [
            {
                id: "common-tools",
                title: "Â∏∏Áî®Â∑•ÂÖ∑",
                icon: "fa-solid fa-toolbox",
                color: "text-indigo-600",
                type: "links", // Á∫ØÈìæÊé•ÁªÑ
                items: [
                    { name: "GitLab", url: "https://gitlab.com", icon: "fa-brands fa-gitlab", desc: "‰ª£Á†Å‰ªìÂ∫ì‰∏é CI/CD" },
                    { name: "Jira", url: "#", icon: "fa-brands fa-jira", desc: "È°πÁõÆ‰∏é‰ªªÂä°ÁÆ°ÁêÜ" },
                    { name: "Confluence", url: "#", icon: "fa-solid fa-book", desc: "Áü•ËØÜÂ∫ì / Wiki" },
                    { name: "Jenkins", url: "#", icon: "fa-brands fa-jenkins", desc: "ÊûÑÂª∫ÂèëÂ∏ÉÂπ≥Âè∞" },
                ]
            },
            {
                id: "sit-env",
                title: "SIT ÁéØÂ¢É (ÊµãËØï)",
                icon: "fa-solid fa-vial",
                color: "text-blue-600",
                badge: "SIT",
                badgeColor: "bg-blue-100 text-blue-700 border-blue-200",
                type: "mixed", // Ê∑∑ÂêàÁªÑÔºöÂåÖÂê´ÈìæÊé•ÂíåÊï∞ÊçÆÂ∫ì
                links: [
                    { name: "SIT ÁõëÊéßÂ§ßÁõò", url: "#", icon: "fa-solid fa-chart-line", desc: "Grafana ÁõëÊéß" },
                    { name: "SIT Êó•Âøó‰∏≠ÂøÉ", url: "#", icon: "fa-solid fa-file-lines", desc: "ELK Êó•ÂøóÊü•ËØ¢" }
                ],
                dbs: [
                    { name: "Áî®Êà∑‰∏≠ÂøÉ‰∏ªÂ∫ì", host: "192.168.10.5", port: "3306", user: "sit_user", pass: "sit_pass_123", type: "mysql" },
                    { name: "ËÆ¢ÂçïÂ∫ì", host: "192.168.10.6", port: "3306", user: "sit_order", pass: "order_pass!", type: "mysql" },
                    { name: "ÂÖ®Â±ÄÁºìÂ≠ò Redis", host: "192.168.10.20", port: "6379", user: "-", pass: "redis_sit_2024", type: "redis" }
                ]
            },
            {
                id: "uat-env",
                title: "UAT ÁéØÂ¢É (È™åÊî∂)",
                icon: "fa-solid fa-check-double",
                color: "text-orange-600",
                badge: "UAT",
                badgeColor: "bg-orange-100 text-orange-700 border-orange-200",
                type: "mixed",
                links: [
                    { name: "UAT ÊºîÁ§∫ÁéØÂ¢É", url: "#", icon: "fa-solid fa-desktop", desc: "ÂÆ¢Êà∑ÊºîÁ§∫ÂÖ•Âè£" }
                ],
                dbs: [
                    { name: "UAT Ê†∏ÂøÉÂ∫ì", host: "10.20.0.5", port: "3306", user: "uat_app", pass: "StrongP@ssw0rd", type: "oracle" }
                ]
            }
        ];

        // ÂÖÅËÆ∏ÁºñËæëÁöÑÂ∑•Âè∑ÁôΩÂêçÂçï
        const ALLOWED_IDS = ["1001", "1002", "admin"];

        // ÂΩìÂâçÁä∂ÊÄÅ
        let isEditMode = false;
        let currentAdminId = null;

        // ================= Ê∏≤ÊüìÈÄªËæë =================

        function render() {
            const container = document.getElementById('app');
            container.innerHTML = '';

            mockData.forEach(group => {
                const section = document.createElement('section');
                
                // 1. ÂàÜÁªÑÊ†áÈ¢ò
                let headerHtml = `
                    <div class="flex items-center justify-between mb-5 pb-2 border-b border-slate-200 group">
                        <div class="flex items-center gap-3">
                            <i class="${group.icon} ${group.color} text-xl"></i>
                            <h2 class="text-xl font-bold text-slate-800">${group.title}</h2>
                            ${group.badge ? `<span class="px-2 py-0.5 text-xs font-bold rounded border ${group.badgeColor}">${group.badge}</span>` : ''}
                        </div>
                        ${isEditMode ? `
                            <div class="opacity-100 transition-opacity flex gap-2">
                                <button class="text-xs bg-slate-100 hover:bg-slate-200 text-slate-600 px-2 py-1 rounded">
                                    <i class="fa-solid fa-plus mr-1"></i>Ê∑ªÂä†ËµÑÊ∫ê
                                </button>
                                <button class="text-xs text-red-500 hover:bg-red-50 px-2 py-1 rounded">Âà†Èô§ÂàÜÁªÑ</button>
                            </div>` 
                        : ''}
                    </div>
                `;

                // 2. Ê∏≤ÊüìÁ´ôÁÇπÈìæÊé• (Grid)
                let linksHtml = '';
                const links = group.type === 'links' ? group.items : (group.links || []);
                
                if (links.length > 0) {
                    linksHtml = `<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-6">`;
                    links.forEach(item => {
                        linksHtml += `
                            <a href="${item.url}" target="_blank" class="relative block p-4 bg-white rounded-lg border border-slate-200 shadow-sm hover:shadow-md hover:border-blue-300 transition group/card">
                                ${isEditMode ? `<button onclick="event.preventDefault(); alert('Âà†Èô§ÈìæÊé•')" class="absolute top-2 right-2 text-slate-300 hover:text-red-500 z-10"><i class="fa-solid fa-trash-can"></i></button>` : ''}
                                <div class="flex items-start gap-3">
                                    <div class="text-2xl text-slate-400 group-hover/card:text-blue-500 transition-colors mt-1">
                                        <i class="${item.icon}"></i>
                                    </div>
                                    <div>
                                        <h3 class="font-semibold text-slate-800 text-sm group-hover/card:text-blue-600">${item.name}</h3>
                                        <p class="text-xs text-slate-500 mt-1 line-clamp-2">${item.desc}</p>
                                    </div>
                                </div>
                            </a>
                        `;
                    });
                    // ÁºñËæëÊ®°Âºè‰∏ãÁöÑ‚ÄúÊ∑ªÂä†ÈìæÊé•‚ÄùÂç†‰ΩçÁ¨¶
                    if (isEditMode) {
                        linksHtml += `
                            <button onclick="alert('Ê∑ªÂä†ÈìæÊé•')" class="flex flex-col items-center justify-center p-4 rounded-lg border-2 border-dashed border-slate-200 text-slate-400 hover:border-blue-400 hover:text-blue-500 transition h-full min-h-[80px]">
                                <i class="fa-solid fa-plus text-lg mb-1"></i>
                                <span class="text-xs font-medium">Ê∑ªÂä†ÈìæÊé•</span>
                            </button>
                        `;
                    }
                    linksHtml += `</div>`;
                }

                // 3. Ê∏≤ÊüìÊï∞ÊçÆÂ∫ìÂàóË°® (Table Style)
                let dbsHtml = '';
                if (group.dbs && group.dbs.length > 0) {
                    dbsHtml = `
                        <div class="bg-white border border-slate-200 rounded-lg shadow-sm overflow-hidden mb-6">
                            <div class="px-4 py-3 bg-slate-50 border-b border-slate-200 flex justify-between items-center">
                                <h3 class="text-sm font-bold text-slate-700"><i class="fa-solid fa-database mr-2"></i>Êï∞ÊçÆÂ∫ìËµÑÊ∫ê</h3>
                                <span class="text-xs text-slate-400">ÁÇπÂáªË°®Ê†ºÂÜÖÂÆπÂç≥ÂèØÂ§çÂà∂</span>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left text-sm">
                                    <thead>
                                        <tr class="bg-white text-slate-500 border-b border-slate-100">
                                            <th class="px-4 py-2 font-medium w-1/4">ÂêçÁß∞</th>
                                            <th class="px-4 py-2 font-medium w-1/4">Host:Port</th>
                                            <th class="px-4 py-2 font-medium w-1/6">User</th>
                                            <th class="px-4 py-2 font-medium w-1/4">Password</th>
                                            ${isEditMode ? '<th class="px-4 py-2 font-medium text-right w-12">Êìç‰Ωú</th>' : ''}
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-slate-50">
                                        ${group.dbs.map(db => `
                                            <tr class="hover:bg-slate-50 transition-colors">
                                                <td class="px-4 py-3">
                                                    <div class="flex items-center gap-2">
                                                        <i class="fa-solid fa-server text-slate-300"></i>
                                                        <span class="font-medium text-slate-700">${db.name}</span>
                                                    </div>
                                                </td>
                                                <td class="px-4 py-3 font-mono text-xs text-slate-600 copy-hover" onclick="copyToClipboard('${db.host}:${db.port}')" title="ÁÇπÂáªÂ§çÂà∂">
                                                    ${db.host}:${db.port}
                                                </td>
                                                <td class="px-4 py-3 font-mono text-xs text-slate-600 copy-hover" onclick="copyToClipboard('${db.user}')" title="ÁÇπÂáªÂ§çÂà∂">
                                                    ${db.user}
                                                </td>
                                                <td class="px-4 py-3 font-mono text-xs text-pink-600 bg-pink-50/50 rounded copy-hover select-all" onclick="copyToClipboard('${db.pass}')" title="ÁÇπÂáªÂ§çÂà∂">
                                                    ${db.pass}
                                                </td>
                                                ${isEditMode ? `
                                                    <td class="px-4 py-3 text-right">
                                                        <button class="text-slate-400 hover:text-red-500 transition"><i class="fa-solid fa-trash-can"></i></button>
                                                    </td>
                                                ` : ''}
                                            </tr>
                                        `).join('')}
                                        ${isEditMode ? `
                                            <tr class="bg-slate-50">
                                                <td colspan="5" class="px-4 py-2 text-center border-t border-dashed border-slate-200">
                                                    <button class="text-xs text-blue-600 hover:text-blue-800 font-medium py-1">
                                                        <i class="fa-solid fa-plus mr-1"></i>Ê∑ªÂä†Êï∞ÊçÆÂ∫ì
                                                    </button>
                                                </td>
                                            </tr>
                                        ` : ''}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                }

                section.innerHTML = headerHtml + linksHtml + dbsHtml;
                container.appendChild(section);
            });
        }

        // ================= ‰∫§‰∫íÈÄªËæë =================

        // 1. ËØ∑Ê±ÇÁÆ°ÁêÜÊùÉÈôê
        function requestAuth() {
            const input = prompt("ËØ∑ËæìÂÖ•Â∑•Âè∑ (Employee ID) ‰ª•ËøõÂÖ•ÁºñËæëÊ®°ÂºèÔºö\n(ÊµãËØïÂèØÁî®: 1001, admin)");
            if (input === null) return;

            if (ALLOWED_IDS.includes(input.trim())) {
                isEditMode = true;
                currentAdminId = input.trim();
                updateUIState();
                showToast(`‚úÖ Ê¨¢Ëøé, ${currentAdminId}„ÄÇÂ∑≤ËøõÂÖ•ÁºñËæëÊ®°Âºè„ÄÇ`);
            } else {
                alert("‚ùå È™åËØÅÂ§±Ë¥•ÔºöÂ∑•Âè∑Êó†ÁºñËæëÊùÉÈôê„ÄÇ");
            }
        }

        // 2. ÈÄÄÂá∫ÁºñËæë
        function exitEditMode() {
            isEditMode = false;
            currentAdminId = null;
            updateUIState();
        }

        // 3. Êõ¥Êñ∞ UI Áä∂ÊÄÅ
        function updateUIState() {
            const adminBar = document.getElementById('admin-bar');
            const authBtn = document.getElementById('auth-btn');
            const adminIdSpan = document.getElementById('admin-id');

            if (isEditMode) {
                adminBar.classList.remove('hidden');
                adminBar.classList.add('flex');
                authBtn.classList.add('hidden');
                adminIdSpan.innerText = currentAdminId;
            } else {
                adminBar.classList.add('hidden');
                adminBar.classList.remove('flex');
                authBtn.classList.remove('hidden');
            }
            
            // ÈáçÊñ∞Ê∏≤ÊüìÂÜÖÂÆπ‰ª•ÊòæÁ§∫/ÈöêËóèÁºñËæëÊåâÈíÆ
            render();
        }

        // 4. ‰øùÂ≠òÈÖçÁΩÆ (Ê®°Êãü)
        function saveConfig() {
            // ÂÆûÈôÖÂºÄÂèë‰∏≠ÔºöËøôÈáå fetch POST ÂèëÈÄÅ JSON
            showToast("üíæ ÈÖçÁΩÆÂ∑≤‰øùÂ≠ò (Ê®°ÊãüÂêéÁ´ØÂÜôÂÖ•)");
            exitEditMode();
        }

        // 5. Â§çÂà∂ÂäüËÉΩ
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast(`Â∑≤Â§çÂà∂: ${text}`);
            }).catch(err => {
                console.error('Â§çÂà∂Â§±Ë¥•', err);
            });
        }

        // 6. Toast ÊèêÁ§∫ÁªÑ‰ª∂
        function showToast(message) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast bg-slate-800 text-white text-sm px-4 py-2 rounded shadow-lg flex items-center gap-2';
            toast.innerHTML = `<i class="fa-solid fa-circle-check text-green-400"></i> <span>${message}</span>`;
            container.appendChild(toast);
            
            // Âä®ÁîªÁªìÊùüÂêéÁßªÈô§ DOM
            setTimeout(() => {
                toast.remove();
            }, 2000);
        }

        // ÂàùÂßãÂåñ
        render();
    </script>
</body>
</html>